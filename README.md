# PatternFly analytics

This project pulls current PatternFly usage metrics across a number of products.

## Usage

- Install dependencies:
  - `npm install`
- Run a new report:
  - `npm run collect`
- View the new report, created within:
  - `/stats-static/{CURRENT-DATE}`

- Create a .csv and .xslx report (see below for installation)
  - `python to_xls.py` 


## Overview

This project references a static list of projects, listed within [repos.json](/repos.json).  A new report is generated by running `npm run collect`, which triggers the functionality within [/src/static-analysis/cli.js](/src/static-analysis/cli.js).

These repositories are cloned locally into a `/tmp` directory, and each are looped through functionality within [getPackageStats.js](/src/static-analysis/getPackageStats.js), [getPatternflyStats.js](/src/static-analysis/getPatternflyStats.js), and [getSortedImports.js](/src/static-analysis/getSortedImports.js) to output the following files:

- `_all_dependencies.json`
  - Groups all projects by shared dependency
- `_all.json`
  - Lists all imported PatternFly assets by import file path or import type
- `_all_sorted.json`
  - Groups together common imported assets regardless of file path from `_all.json` and sorts them by total imported quantity across repos.


## Installation of the Python code

```shell
# 1) Install a venv (only needed once)
python3 -m venv .venv
# 2) Activate it
source .venv/bin/activate
# 3) Install packages
python3 -m pip install pandas xlswriter
# 4) Run the code
python3 to_xls.py
# 5) (Optional) Deactivate the venv again
deactivate
```

If step 3 fails, you need to install pip. on Linux e.g.
via `dnf install python3-pip`.
`